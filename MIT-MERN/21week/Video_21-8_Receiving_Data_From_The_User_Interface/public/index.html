<!DOCTYPE html>
<html>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/superagent/3.8.3/superagent.min.js"></script>

<body>

    <main role="main" class="container" style="margin-top:20px">

        <div id="status" style="height: 100px"></div>

        <h5>Read</h5>
        <button type="button" class="btn btn-primary" onclick="data()">Show All Data</button><br/><br/>

        <h5>Find Published</h5>
        <label for="findPublish">Publish</label><br/>
        <input type="checkbox" id="findPublish"><br/>
        <button type="button" class="btn btn-primary" onclick="findPublish()">Find Published</button><br/><br/>

        <h5>Insert</h5>
        <form>
            <label for="insertID">ID</label><br/>
            <input type="number" id="insertID"><br/>
            <label for="insertTitle">Title</label><br/>
            <input type="text" id="insertTitle"><br/>
            <label for="insertPublish">Publish</label><br/>
            <input type="checkbox" id="insertPublish"><br/>
            <button type="submit" class="btn btn-primary" onclick="insert(event)">Insert Data</button><br/><br/>
        </form>

        <h5>Update</h5>
        <label for="updateID">ID</label><br/>
        <input type="number" id="updateID"><br/>
        <label for="updatePublish">Publish</label><br/>
        <input type="checkbox" id="updatePublish"><br/>
        <button type="button" class="btn btn-primary" onclick="updatePublish()">Update Published</button><br/><br/>

        <h5>Delete</h5>
        <form>
            <label for="deleteID">ID</label><br/>
            <input type="number" id="deleteID"><br/>
            <button type="submit" class="btn btn-primary" onclick="deleteRow(event)">Delete Row</button><br/><br/>
        </form>

    </main>

</body>
<script>

    function superAgent(url) {
        const status = document.getElementById('status');

        superagent
            .get(url)
            .end(
                function(err, res) {
                    if (err) {
                        console.log(err);
                    } else {
                        console.log(res);
                        status.innerHTML = JSON.stringify(res.body);
                    }
                }
            );
    }

    function data() {
        const url = '/data';

        superAgent(url);
    }

    function findPublish(event) {
        const publish = document.getElementById('findPublish').checked;
        const url = `/published/${publish}`
        console.log(publish);
        superAgent(url)
    }

    function insert(event) {
        const id = Number(event.target.form.elements.insertID.value);
        const title = event.target.form.elements.insertTitle.value;
        const publish = event.target.form.elements.insertPublish.checked;
        const url = `/posts/${title}/${id}/${publish}`;
        console.log(id);
        console.log(title);
        console.log(publish);
        superAgent(url);
        event.preventDefault();
    }

    function updatePublish(event) {
        const id = document.getElementById('updateID').value;
        const publish = document.getElementById('updatePublish').checked;
        const url = `/published/${id}/${publish}`
        console.log(id);
        console.log(publish);
        superAgent(url)
    }

    function deleteRow(event) {
        const id = Number(event.target.form.elements.deleteID.value);
        const url = `/delete/${id}`;
        console.log(id);
        superAgent(url);
        event.preventDefault();
    }


</script>
</html>
